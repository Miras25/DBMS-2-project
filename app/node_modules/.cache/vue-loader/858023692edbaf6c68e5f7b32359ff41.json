{"remainingRequest":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Downloads\\project\\app\\src\\views\\stores\\Search.vue?vue&type=script&lang=ts&","dependencies":[{"path":"C:\\Users\\User\\Downloads\\project\\app\\src\\views\\stores\\Search.vue","mtime":1607058588000},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1619785757533},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\babel-loader\\lib\\index.js","mtime":1619785757509},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\ts-loader\\index.js","mtime":1619785330507},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1619785757533},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1619785764623}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHsgUGhhcm1hY3kgfSBmcm9tICJAL0B0eXBlcyI7CmltcG9ydCB7IENvbXBvbmVudCwgVnVlIH0gZnJvbSAidnVlLXByb3BlcnR5LWRlY29yYXRvciI7CmltcG9ydCB7IGFwaSB9IGZyb20gIkAvYXBpIjsKaW1wb3J0IEdpc01hcCBmcm9tICJAL2NvbXBvbmVudHMvR2lzTWFwLnZ1ZSI7CgpAQ29tcG9uZW50KHsKICBjb21wb25lbnRzOiB7IEdpc01hcCB9LAp9KQpleHBvcnQgZGVmYXVsdCBjbGFzcyBTdG9yZXNTZWFyY2hWaWV3IGV4dGVuZHMgVnVlIHsKICBsaXN0OiBQaGFybWFjeVtdID0gW107CiAgY291bnQgPSAwOwogIGlzRW5kID0gZmFsc2U7CgogICRyZWZzOiB7CiAgICBtYXA6IEdpc01hcDsKICB9OwoKICBwdWJsaWMgYXN5bmMgZmV0Y2gob2Zmc2V0OiBudW1iZXIpIHsKICAgIGNvbnN0IHsgcXVlcnkgfSA9IHRoaXMuJHJvdXRlLnF1ZXJ5OwogICAgY29uc3QgewogICAgICBkYXRhOiB7IHJlc3VsdCwgY291bnQgfSwKICAgIH0gPSBhd2FpdCBhcGkuZ2V0KGAvc3RvcmVzP3F1ZXJ5PSR7cXVlcnl9Jm9mZnNldD0ke29mZnNldH1gKTsKICAgIGlmIChyZXN1bHQubGVuZ3RoID09IDApIHsKICAgICAgdGhpcy5pc0VuZCA9IHRydWU7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHRoaXMubGlzdC5wdXNoKC4uLnJlc3VsdCk7CiAgICB0aGlzLmNvdW50ID0gY291bnQ7CgogICAgdGhpcy4kcmVmcy5tYXAudXBkYXRlTWFya2VycygpOwogIH0KCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIGF3YWl0IHRoaXMuZmV0Y2goMCk7CiAgfQp9Cg=="},{"version":3,"sources":["Search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA","file":"Search.vue","sourceRoot":"src/views/stores","sourcesContent":["<template>\n  <div class=\"pb-10\">\n    <p class=\"subtitle\">Найдено {{ count }} аптек</p>\n    <v-card\n      v-for=\"store in list\"\n      :key=\"store.ID + Math.random()\"\n      class=\"mb-4\"\n      outlined\n      elevation=\"0\"\n    >\n      <v-card-title>{{ store.TITLE }}</v-card-title>\n      <v-card-subtitle>{{ store.ADDRESS }}</v-card-subtitle>\n      <v-card-text class=\"d-flex justify-space-between\">\n        <span>{{ store.PHONES }}</span>\n      </v-card-text>\n    </v-card>\n    <v-btn\n      large\n      v-if=\"!isEnd\"\n      color=\"primary\"\n      width=\"100%\"\n      @click=\"fetch(list.length)\"\n    >\n      Загрузить еще\n    </v-btn>\n    <gis-map ref=\"map\" class=\"map\" :stores=\"list\"></gis-map>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Pharmacy } from \"@/@types\";\nimport { Component, Vue } from \"vue-property-decorator\";\nimport { api } from \"@/api\";\nimport GisMap from \"@/components/GisMap.vue\";\n\n@Component({\n  components: { GisMap },\n})\nexport default class StoresSearchView extends Vue {\n  list: Pharmacy[] = [];\n  count = 0;\n  isEnd = false;\n\n  $refs: {\n    map: GisMap;\n  };\n\n  public async fetch(offset: number) {\n    const { query } = this.$route.query;\n    const {\n      data: { result, count },\n    } = await api.get(`/stores?query=${query}&offset=${offset}`);\n    if (result.length == 0) {\n      this.isEnd = true;\n      return;\n    }\n    this.list.push(...result);\n    this.count = count;\n\n    this.$refs.map.updateMarkers();\n  }\n\n  async created() {\n    await this.fetch(0);\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.map {\n  position: fixed;\n  right: 0;\n  top: 64px;\n  width: calc(100vw - 550px - 60px - 58px);\n  height: calc(100vh - 64px);\n  z-index: 1;\n}\n</style>\n"]}]}