{"remainingRequest":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Downloads\\project\\app\\src\\views\\posts\\Moderation.vue?vue&type=script&lang=ts&","dependencies":[{"path":"C:\\Users\\User\\Downloads\\project\\app\\src\\views\\posts\\Moderation.vue","mtime":1607058339000},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1619785757533},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\babel-loader\\lib\\index.js","mtime":1619785757509},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\ts-loader\\index.js","mtime":1619785330507},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1619785757533},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1619785764623}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7IFBvc3QgfSBmcm9tICJAL0B0eXBlcyI7CmltcG9ydCB7IENvbXBvbmVudCwgVnVlIH0gZnJvbSAidnVlLXByb3BlcnR5LWRlY29yYXRvciI7CmltcG9ydCB7IGFwaSB9IGZyb20gIkAvYXBpIjsKaW1wb3J0IENvbmZpcm1hdGlvbkRpYWxvZyBmcm9tICJAL2NvbXBvbmVudHMvQ29uZmlybWF0aW9uRGlhbG9nLnZ1ZSI7CgpAQ29tcG9uZW50KHsKICBjb21wb25lbnRzOiB7IENvbmZpcm1hdGlvbkRpYWxvZyB9LAp9KQpleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RlcmF0aW9uVmlldyBleHRlbmRzIFZ1ZSB7CiAgbGlzdDogUG9zdFtdID0gW107CgogICRyZWZzOiB7CiAgICBkaWFsb2c6IENvbmZpcm1hdGlvbkRpYWxvZzsKICB9OwoKICBwdWJsaWMgYXN5bmMgY29uZmlybShpZDogbnVtYmVyKSB7CiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLiRyZWZzLmRpYWxvZy5zaG93KCLQktGLINGD0LLQtdGA0LXQvdGLPyIpOwogICAgaWYgKCFyZXN1bHQpIHJldHVybjsKICAgIGF3YWl0IGFwaS5wdXQoYC9wb3N0cy8ke2lkfS9jb25maXJtYCk7CiAgICBjb25zdCBpdGVtID0gdGhpcy5saXN0LmZpbmQoKGl0ZW0pID0+IGl0ZW0uSUQgPT0gaWQpOwogICAgaXRlbS5QT1NUX1NUQVRVUyA9ICJwdWJsaXNoZWQiOwogIH0KCiAgcHVibGljIGFzeW5jIGRlbnkoaWQ6IG51bWJlcikgewogICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy4kcmVmcy5kaWFsb2cuc2hvdygi0JLRiyDRg9Cy0LXRgNC10L3Riz8iKTsKICAgIGlmICghcmVzdWx0KSByZXR1cm47CiAgICBhd2FpdCBhcGkucHV0KGAvcG9zdHMvJHtpZH0vZGVueWApOwogICAgdGhpcy5saXN0ID0gdGhpcy5saXN0LmZpbHRlcigoaXRlbSkgPT4gaXRlbS5JRCAhPSBpZCk7CiAgfQoKICBwdWJsaWMgYXN5bmMgZmV0Y2goKSB7CiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGFwaS5nZXQoIi9wb3N0cy9jb25maXJtYXRpb24iKTsKICAgIHRoaXMubGlzdCA9IGRhdGE7CiAgfQoKICBwdWJsaWMgcGFyc2VTdGF0dXMoc3RhdHVzOiBzdHJpbmcpIHsKICAgIGlmIChzdGF0dXMgPT0gInJlY2lwZSIpIHsKICAgICAgcmV0dXJuICLQn9C+INGA0LXRhtC10L/RgtGDIjsKICAgIH0KICAgIHJldHVybiAi0JHQtdC3INGA0LXRhtC10L/RgtCwIjsKICB9CgogIHB1YmxpYyBwYXJzZURhdGUoZGF0ZTogc3RyaW5nKSB7CiAgICBjb25zdCB0ZW1wID0gbmV3IERhdGUoZGF0ZSk7CiAgICByZXR1cm4gdGVtcC50b0xvY2FsZURhdGVTdHJpbmcoKS5yZXBsYWNlKC9cLy9nLCAiLiIpOwogIH0KCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIGlmICghdGhpcy4kc3RvcmUuc3RhdGUubG9nZ2VkSW4gfHwgIXRoaXMuaXNBZG1pbikgewogICAgICByZXR1cm4gdGhpcy4kcm91dGVyLmJhY2soKTsKICAgIH0KICAgIGF3YWl0IHRoaXMuZmV0Y2goKTsKICB9CgogIGdldCBpc0FkbWluKCkgewogICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuUEhPTkUgPT0gIis3ICg3MDgpIDYxNCA0NiA3MiI7CiAgfQp9Cg=="},{"version":3,"sources":["Moderation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Moderation.vue","sourceRoot":"src/views/posts","sourcesContent":["<template>\n  <div id=\"my-posts\" class=\"d-flex pb-10 pt-15 px-16\">\n    <div class=\"wrapper\">\n      <h1 class=\"py-4 medicines-title\">\n        Объявления на подтверждение\n      </h1>\n      <p class=\"subtitle\">Найдено {{ list.length }} препаратов</p>\n      <v-card v-for=\"item in list\" :key=\"item.ID + Math.random()\" class=\"mb-5\">\n        <v-card-title>{{ item.TITLE }}</v-card-title>\n        <v-card-subtitle class=\"d-flex justify-space-between\">\n          <span class=\"primary--text\">{{ parseStatus(item.STATUS) }}</span>\n        </v-card-subtitle>\n        <v-card-text>\n          <v-container class=\"pa-0\">\n            <v-row>\n              <v-col cols=\"6\" class=\"py-0\">Срок годности:</v-col>\n              <v-col cols=\"6\" class=\"py-0 primary--text\">{{\n                parseDate(item.EXPIRES)\n              }}</v-col>\n            </v-row>\n            <v-row>\n              <v-col cols=\"6\" class=\"py-0\">Количество/состояние:</v-col>\n              <v-col cols=\"6\" class=\"py-0 primary--text\">{{\n                item.AMOUNT\n              }}</v-col>\n            </v-row>\n            <v-row>\n              <v-col cols=\"6\" class=\"py-0\">Способ хранения:</v-col>\n              <v-col cols=\"6\" class=\"py-0 primary--text\">{{\n                item.STORAGE\n              }}</v-col>\n            </v-row>\n            <v-row>\n              <v-col cols=\"6\" class=\"py-0\">Контакты:</v-col>\n              <v-col cols=\"6\" class=\"py-0 primary--text\">{{\n                item.CONTACTS\n              }}</v-col>\n            </v-row>\n          </v-container>\n        </v-card-text>\n        <v-card-actions class=\"pb-4 px-4\">\n          <v-btn width=\"150\" color=\"primary\" @click=\"confirm(item.ID)\">\n            Подтвердить\n          </v-btn>\n          <v-btn width=\"150\" color=\"primary\" @click=\"deny(item.ID)\">\n            Отказать\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </div>\n    <confirmation-dialog ref=\"dialog\"></confirmation-dialog>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Post } from \"@/@types\";\nimport { Component, Vue } from \"vue-property-decorator\";\nimport { api } from \"@/api\";\nimport ConfirmationDialog from \"@/components/ConfirmationDialog.vue\";\n\n@Component({\n  components: { ConfirmationDialog },\n})\nexport default class ModerationView extends Vue {\n  list: Post[] = [];\n\n  $refs: {\n    dialog: ConfirmationDialog;\n  };\n\n  public async confirm(id: number) {\n    const result = await this.$refs.dialog.show(\"Вы уверены?\");\n    if (!result) return;\n    await api.put(`/posts/${id}/confirm`);\n    const item = this.list.find((item) => item.ID == id);\n    item.POST_STATUS = \"published\";\n  }\n\n  public async deny(id: number) {\n    const result = await this.$refs.dialog.show(\"Вы уверены?\");\n    if (!result) return;\n    await api.put(`/posts/${id}/deny`);\n    this.list = this.list.filter((item) => item.ID != id);\n  }\n\n  public async fetch() {\n    const { data } = await api.get(\"/posts/confirmation\");\n    this.list = data;\n  }\n\n  public parseStatus(status: string) {\n    if (status == \"recipe\") {\n      return \"По рецепту\";\n    }\n    return \"Без рецепта\";\n  }\n\n  public parseDate(date: string) {\n    const temp = new Date(date);\n    return temp.toLocaleDateString().replace(/\\//g, \".\");\n  }\n\n  async created() {\n    if (!this.$store.state.loggedIn || !this.isAdmin) {\n      return this.$router.back();\n    }\n    await this.fetch();\n  }\n\n  get isAdmin() {\n    return this.$store.state.user.PHONE == \"+7 (708) 614 46 72\";\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.wrapper,\n.form {\n  max-width: 550px;\n  flex: 1;\n}\n</style>\n\n<style lang=\"scss\">\n#my-posts {\n  .v-autocomplete.v-select--is-menu-active .v-input__icon--append .v-icon {\n    transform: none;\n  }\n}\n</style>\n"]}]}