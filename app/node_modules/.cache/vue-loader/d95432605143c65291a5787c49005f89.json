{"remainingRequest":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Downloads\\project\\app\\src\\views\\posts\\MyPosts.vue?vue&type=style&index=1&lang=scss&","dependencies":[{"path":"C:\\Users\\User\\Downloads\\project\\app\\src\\views\\posts\\MyPosts.vue","mtime":1607057369000},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\css-loader\\dist\\cjs.js","mtime":1619785764282},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1619785764623},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\postcss-loader\\src\\index.js","mtime":1619785764560},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1619785769875},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1619785757533},{"path":"C:\\Users\\User\\Downloads\\project\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":1619785764623}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCiNteS1wb3N0cyB7CiAgLnYtYXV0b2NvbXBsZXRlLnYtc2VsZWN0LS1pcy1tZW51LWFjdGl2ZSAudi1pbnB1dF9faWNvbi0tYXBwZW5kIC52LWljb24gewogICAgdHJhbnNmb3JtOiBub25lOwogIH0KfQo="},{"version":3,"sources":["MyPosts.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwOA;AACA;AACA;AACA;AACA","file":"MyPosts.vue","sourceRoot":"src/views/posts","sourcesContent":["<template>\n  <div id=\"my-posts\" class=\"d-flex pb-10 pt-15 px-16\">\n    <div class=\"wrapper\">\n      <h1 class=\"py-4 medicines-title\">\n        Мои объявления\n      </h1>\n      <p class=\"subtitle\">Найдено {{ list.length }} препаратов</p>\n      <v-card v-for=\"item in list\" :key=\"item.ID + Math.random()\" class=\"mb-5\">\n        <v-card-title>{{ item.TITLE }}</v-card-title>\n        <v-card-subtitle class=\"d-flex justify-space-between\">\n          <span class=\"primary--text\">{{ parseStatus(item.STATUS) }}</span>\n          <span class=\"primary--text\">{{\n            parsePostStatus(item.POST_STATUS)\n          }}</span>\n        </v-card-subtitle>\n        <v-card-text>\n          <v-container class=\"pa-0\">\n            <v-row>\n              <v-col cols=\"6\" class=\"py-0\">Срок годности:</v-col>\n              <v-col cols=\"6\" class=\"py-0 primary--text\">{{\n                parseDate(item.EXPIRES)\n              }}</v-col>\n            </v-row>\n            <v-row>\n              <v-col cols=\"6\" class=\"py-0\">Количество/состояние:</v-col>\n              <v-col cols=\"6\" class=\"py-0 primary--text\">{{\n                item.AMOUNT\n              }}</v-col>\n            </v-row>\n            <v-row>\n              <v-col cols=\"6\" class=\"py-0\">Способ хранения:</v-col>\n              <v-col cols=\"6\" class=\"py-0 primary--text\">{{\n                item.STORAGE\n              }}</v-col>\n            </v-row>\n            <v-row>\n              <v-col cols=\"6\" class=\"py-0\">Контакты:</v-col>\n              <v-col cols=\"6\" class=\"py-0 primary--text\">{{\n                item.CONTACTS\n              }}</v-col>\n            </v-row>\n          </v-container>\n        </v-card-text>\n        <v-card-actions\n          class=\"pb-4 px-4\"\n          v-if=\"!['denied', 'archived'].includes(item.POST_STATUS)\"\n        >\n          <v-btn\n            width=\"100\"\n            color=\"primary\"\n            v-if=\"item.POST_STATUS == 'published'\"\n            @click=\"ask(item.ID)\"\n          >\n            В Архив\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </div>\n    <v-form class=\"ml-10 form\" ref=\"form\" lazy-validation>\n      <h1 class=\"py-4 medicines-title\">\n        Подать объявление\n      </h1>\n      <v-combobox\n        ref=\"box\"\n        full-width\n        :search-input.sync=\"title\"\n        solo\n        clearable\n        :loading=\"loading\"\n        :items=\"suggestions\"\n        item-text=\"TITLE\"\n        item-value=\"ID\"\n        placeholder=\"Введите название препарата\"\n        append-icon=\"mdi-magnify\"\n        class=\"mt-10\"\n      >\n      </v-combobox>\n      <v-radio-group v-model=\"recipe\" class=\"mt-0\">\n        <v-radio label=\"Без рецепта\" value=\"no_recipe\"></v-radio>\n        <v-radio label=\"По рецепту\" value=\"recipe\"></v-radio>\n      </v-radio-group>\n      <v-text-field\n        v-model=\"amount\"\n        label=\"Количество или состояние\"\n        outlined\n        :rules=\"[rules.required]\"\n      ></v-text-field>\n      <v-text-field\n        v-model=\"storage\"\n        label=\"Способ хранения\"\n        outlined\n        :rules=\"[rules.required]\"\n      ></v-text-field>\n      <date-picker v-model=\"expires\" :rules=\"[rules.required]\"></date-picker>\n      <v-text-field\n        v-model=\"contacts\"\n        label=\"Контакты\"\n        outlined\n        :rules=\"[rules.required]\"\n      ></v-text-field>\n      <v-checkbox\n        class=\"mt-0\"\n        v-model=\"accept\"\n        label=\"* Я принимаю Правила размещения объявлений и Условия использования сайта\"\n        :rules=\"[rules.required]\"\n      ></v-checkbox>\n      <v-btn color=\"primary\" @click=\"add\">Добавить</v-btn>\n    </v-form>\n    <confirmation-dialog ref=\"dialog\"></confirmation-dialog>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { MedicinesSuggestion, Post } from \"@/@types\";\nimport { Component, Vue } from \"vue-property-decorator\";\nimport { api } from \"@/api\";\nimport ConfirmationDialog from \"@/components/ConfirmationDialog.vue\";\nimport DatePicker from \"@/components/DatePicker.vue\";\nimport { VForm } from \"@/@types\";\nimport debounce from \"lodash.debounce\";\n\n@Component({\n  components: { ConfirmationDialog, DatePicker },\n  watch: {\n    title: \"fetchSuggestions\",\n  },\n  methods: {\n    fetchSuggestions: debounce(async function(this: MyPostsView, val: string) {\n      if (!val) return;\n      if (val.length < 1) return;\n      this.loading = true;\n      const { data } = await api.get(\"/medicines/autocomplete?query=\" + val);\n      this.suggestions = data;\n      this.loading = false;\n    }, 500),\n  },\n})\nexport default class MyPostsView extends Vue {\n  list: Post[] = [];\n  title = \"\";\n  suggestions: MedicinesSuggestion[] = [];\n  loading = false;\n  recipe = \"\";\n  amount = \"\";\n  storage = \"\";\n  expires = \"\";\n  contacts = \"\";\n  accept = false;\n\n  $refs: {\n    dialog: ConfirmationDialog;\n    form: VForm;\n  };\n\n  rules = {\n    required: (value) => !!value || \"Обязательное поле\",\n    min: (v) => v.length >= 8 || \"Минимум 8 символов\",\n    phone: (v) =>\n      /^(\\+7) \\([0-9]{3}\\) ([0-9]{3}) ([0-9]{2}) ([0-9]{2})$/.test(v) ||\n      \"Правильный номер\",\n  };\n\n  public async ask(id: number) {\n    const result = await this.$refs.dialog.show(\"Вы уверены?\");\n    if (!result) return;\n    await this.archive(id);\n    const item = this.list.find((item) => item.ID == id);\n    item.POST_STATUS = \"archived\";\n  }\n\n  public async add() {\n    if (!this.$refs.form.validate()) return;\n\n    const result = await this.$refs.dialog.show(\"Вы уверены?\");\n    if (!result) return;\n    await api.post(\"/posts\", {\n      title: this.title,\n      status: this.recipe,\n      amount: this.amount,\n      storage: this.storage,\n      expires: new Date(Date.parse(this.expires)).toString(),\n      contacts: this.contacts,\n    });\n    this.$refs.form.reset();\n  }\n\n  public async fetch() {\n    const { data } = await api.get(\"/posts/my\");\n    this.list = data;\n  }\n\n  public parseStatus(status: string) {\n    if (status == \"recipe\") {\n      return \"По рецепту\";\n    }\n    return \"Без рецепта\";\n  }\n\n  public parsePostStatus(status: string) {\n    if (status == \"processing\") return \"В обработке\";\n    if (status == \"published\") return \"Опубликовано\";\n    if (status == \"denied\") return \"Отклонено\";\n    if (status == \"archived\") return \"В архиве\";\n  }\n\n  public parseDate(date: string) {\n    const temp = new Date(date);\n    return temp.toLocaleDateString().replace(/\\//g, \".\");\n  }\n\n  async created() {\n    if (!this.$store.state.loggedIn) {\n      return this.$router.back();\n    }\n    await this.fetch();\n  }\n\n  public async archive(id: number) {\n    await api.put(`/posts/${id}/archive`);\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.wrapper,\n.form {\n  max-width: 550px;\n  flex: 1;\n}\n</style>\n\n<style lang=\"scss\">\n#my-posts {\n  .v-autocomplete.v-select--is-menu-active .v-input__icon--append .v-icon {\n    transform: none;\n  }\n}\n</style>\n"]}]}